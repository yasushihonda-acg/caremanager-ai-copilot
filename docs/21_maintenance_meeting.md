# 21_maintenance_meeting.md - 緊急メンテナンス会議議事録

## 会議概要
*   **日時:** 2025年11月21日
*   **テーマ:** リアルタイム解析における「要約重複問題」と「動作の不透明さ」の解消
*   **参加者:** プロジェクトリーダー、リードエンジニア

## 1. 障害事象 (Symptom)
1.  **要約のループ:** 30秒ごとの解析結果が追記され続け、同じような内容（「健康状態は良好で...」）が何度も繰り返される。
2.  **ブラックボックス化:** デモ設定（30秒）で動作しているのか、エラーで止まっているのかが画面上およびコンソール上で判断できない。

## 2. 原因分析 (Root Cause)
*   **累積バッファの影響:** Phase 5でWebMヘッダー対策として「累積音声（全データ）」をAIに送るように変更した。これにより、AIは毎回「最初から現在までの全要約」を生成して返却している。
*   **Frontendロジックの不整合:** UI側 (`TouchAssessment.tsx`) が、以前の仕様（差分チャンク）の名残で `prev + newSummary` (追記) のままになっていた。これが重複の原因。
*   **ログ不足:** バックグラウンド処理（`setInterval` 内）のログ出力が実装されていなかった。

## 3. 対策 (Solution)
1.  **Overwrite戦略:** AIは常に「最新の完全な要約」を返しているため、UI側は追記ではなく**上書き**する仕様に変更する。
2.  **UIフィードバック:** 「最終解析時刻: HH:mm:ss」を画面に表示し、システムが生きていることをユーザーに伝える。
3.  **Structured Logging:** コンソールに `[CFM-DEBUG]` プレフィックス付きで、処理サイズと時間を記録する。

## 4. 修正対象
*   `components/TouchAssessment.tsx`
*   `services/geminiService.ts` (プロンプトの微調整: 冗長さを省くよう指示)