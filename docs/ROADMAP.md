# 開発ロードマップ - ケアマネのミカタ 2025

> **作成日**: 2026-01-25
> **最終更新**: 2026-02-18
>
> **基準ドキュメント**: [care-manager-insights-2025.md](research/care-manager-insights-2025.md)
> **開発モデル**: [ADR 0009 - ステージベース開発モデル](adr/0009-stage-based-development-model.md)

---

## 開発ステージ概要

| Stage | 名称 | 目的 | 状態 |
|-------|------|------|------|
| 1 | MVP Foundation | 全機能のEnd-to-End動作 | ✅完了 |
| 2 | Production Readiness | 品質保証・精度検証 | ✅完了 |
| 3 | Pilot Deployment | 実ユーザーでの検証 | 🔄進行中 |
| 4 | Scale & Enhancement | フィードバック反映・新機能 | 🔮将来 |

---

## Stage 1: MVP Foundation ✅完了

### 完了済み機能

| 機能 | コンポーネント | 説明 |
|------|--------------|------|
| 音声録音・解析 | `App.tsx` | 30秒間隔のリアルタイム音声解析 |
| 23項目アセスメント抽出 | `geminiService.ts` | Gemini 2.5 Flashによる自動抽出 |
| ケアプラン原案生成 | `geminiService.ts` | 第1表・第2表の自動生成 |
| 印刷プレビュー | `PrintPreview.tsx` | 第1表・第2表の印刷対応 |
| データ永続化 | `firebase.ts` | Firestore保存・読込 |
| 認証 | `LoginScreen.tsx` | Google OAuth認証 |
| 利用者データベース | `components/clients/` | 複数利用者管理（Firestoreネスト方式） |
| モニタリング記録 | `components/monitoring/` | 差分入力UI・前回比較・定型文テンプレート |
| 支援経過記録 | `components/records/` | 音声入力・検索・フィルタ機能 |
| サービス担当者会議記録 | `components/meeting/` | 第4表データモデル・UI |
| 入院時情報連携シート | `components/documents/` | アセスメント連携・自動生成 |
| アセスメント進捗表示 | `components/assessment/` | 未入力ハイライト・進捗バー |
| 第2表文例データベース | `careplanExamples.ts` | 6疾患カテゴリ、30+文例 |
| ケアプラン生成V2 API | `generateCarePlanV2` | 複数ニーズ対応 |
| アセスメント抽出テスト | `tests/assessment/` | 6シナリオ、Vitest |
| UX改善バッチ | 各コンポーネント | 検索フィルタ・進捗バー・定型文テンプレート |
| デモ用シードデータ | `scripts/seed.ts` | 3名分の利用者データ |

---

## Stage 2: Production Readiness ✅完了

### 達成事項

- AI抽出精度90%実証（PR #12）
- 抽出ルール最適化（PR #13）
- サイレント失敗エラーハンドリング修正9箇所（PR #14）
- ニーズ→目標の整合性チェック実装（PR #15）
- Emulator環境整備（PR #11）
- CI/CD正常稼働（GitHub Actions + Workload Identity）

---

## Stage 2: Production Readiness（アーカイブ）

### P0: ブロッカー（パイロット前に必須）

| タスク | 内容 | 見積 | 依存 |
|--------|------|------|------|
| ADC再認証 | `gcloud auth application-default login`（hy.unimail.11@gmail.com） | 10分 | なし |
| AI精度の実地テスト | Cloud Functions連携テスト実装 | 2-3日 | ADC |
| 抽出ルール最適化 | 弱点4項目（healthStatus, pastHistory, iadlCooking, environment）の改善 | 3-5日 | 実地テスト結果 |
| エラーハンドリング監査 | 本番障害防止（transient/permanent分類、状態復旧優先） | 2日 | なし |
| Emulator環境整備 | ✅ ローカル開発環境（Auth/Firestore/Functions Emulator接続、自動ログイン、シードデータ） | 完了 | なし |

### P1: 品質向上（パイロット品質を高める）

| タスク | 内容 | 見積 |
|--------|------|------|
| ニーズ→目標の整合性チェック | 論理的整合性の自動検証 | 3日 |
| サービス種別・頻度提案 | AI提案の精度向上 | 2日 |
| 文例バリエーション増加 | 同じニーズに複数表現 | 2日 |

### P2: 延期可能（パイロット後に判断）

| タスク | 元フェーズ | 延期理由 |
|--------|-----------|---------|
| 音声→構造化変換 | Phase 2 | ROI低い、手動入力で代替可 |
| 議事録自動生成 | Phase 3 | 実装難度高、パイロットフィードバック待ち |
| PDF出力 | Phase 3 | 印刷プレビュー→PDF印刷で代替可 |
| 検討事項テンプレート | Phase 3 | 優先度低 |
| 欠席者照会管理 | Phase 3 | 優先度低 |

---

## Stage 3: Pilot Deployment 🔄（現在地）

- **対象**: 3-5名のケアマネージャー
- **期間**: 2026-02-19 〜 2026-06-30（M3目標）
- **退出基準**: 満足度80%+、重大バグ0

### 実装済み機能

| タスク | 内容 | 状態 |
|--------|------|------|
| メール許可リスト | `allowed_emails` コレクション + AuthContextチェック | ✅ |
| Firestoreセキュリティルール | allowed_emails/feedback/usage_logs ルール追加 | ✅ |
| シードスクリプト更新 | Emulatorテストユーザー許可リスト追加 | ✅ |
| フィードバックFAB | アプリ内フィードバックボタン（右下固定、Firestoreに保存） | ✅ |
| Cloud Functions structured logging | `logger.error/info` 導入（Cloud Logging連携） | ✅ |
| 利用ログ記録 | `usage_logs` コレクション（ケアプラン生成時に記録） | ✅ |

| 認定有効期限・モニタリング期限アラート（#22） | 期限60日前/30日前/超過のバナー警告、ADR 0011準拠 | ✅ |
| 初回利用オンボーディング・操作ガイド（#23） | 4ステップモーダルツアー（初回自動表示・メニューから再表示） | ✅ |
| ダッシュボード/業務サマリー画面（#24） | 期限アラート・最近の利用者・件数サマリー・クイックアクション | ✅ |

### 次のアクション

| # | タスク | 状態 |
|---|--------|------|
| 1 | パイロットユーザーのメールアドレスをFirestoreに登録 | 🔲 手動 |
| 2 | パイロットユーザーへの案内 | 🔲 |

---

## Stage 4: Scale & Enhancement 🔮

- 給付管理サポート（旧Phase 4）→ パイロットフィードバックで優先度を再判断
- P2延期機能 → ニーズに応じて実装

---

## マイルストーン

| マイルストーン | 目標日 | 退出基準 | 状態 |
|--------------|--------|---------|------|
| M1: MVP Complete | 2026-02-10 | 全機能デモ可能 | ✅完了 |
| M2: Production Ready | 2026-03-31 | P0完了、AI精度85%+実証 | 🔲未達 |
| M3: Pilot Complete | 2026-06-30 | 3-5名、2ヶ月、満足度80%+ | 🔲未着手 |
| M4: Scale Decision | 2026-07-31 | Go/No-Go判定 | 🔲未着手 |

---

## 現在のアーキテクチャ

```
┌───────────────────────────────────────────────────────────────┐
│                    フロントエンド (React 19 + Vite)            │
├──────────┬──────────┬──────────┬──────────┬──────────────────┤
│ App.tsx  │Assessment│ CarePlan │Monitoring│ Records/Meeting  │
│ (メイン) │ (入力)   │ (生成)   │ (評価)   │ (経過/会議)      │
├──────────┴──────────┴──────────┴──────────┴──────────────────┤
│ contexts/ (Auth, Client)  │  services/ (firebase, gemini)    │
└───────────┬───────────────┴───────────┬──────────────────────┘
            │                           │
            ▼                           ▼
┌───────────────────────────────────────────────────────────────┐
│              Cloud Functions for Firebase                      │
│  - analyzeVoice (音声解析)                                    │
│  - generateCarePlan / V2 (ケアプラン生成)                     │
└───────────────────────────────────────────────────────────────┘
            │
            ▼
┌───────────────────────────────────────────────────────────────┐
│              Vertex AI (Gemini 2.5 Flash)                     │
└───────────────────────────────────────────────────────────────┘
```

**コンポーネント構成:**
```
components/
├── assessment/          # アセスメント（進捗バー・未入力ハイライト付き）
├── careplan/            # ケアプラン生成・表示
├── clients/             # 利用者管理（一覧・登録・編集・コンテキストバー）
├── documents/           # 入院時情報連携シート
├── meeting/             # サービス担当者会議記録（第4表）
├── monitoring/          # モニタリング記録（差分入力・定型文テンプレート）
└── records/             # 支援経過記録（第5表・検索フィルタ・音声入力）
```

---

## リスクと対策

| リスク | 影響 | 対策 |
|-------|------|------|
| Gemini APIの仕様変更 | 機能停止 | バージョン固定、エラーハンドリング強化 |
| 法改正への対応遅れ | 実務で使えない | ADRでの変更追跡、定期的な制度確認 |
| データ量増加 | コスト増、パフォーマンス低下 | Firestoreインデックス最適化、古いデータのアーカイブ |

---

## 参考資料

- [ADR一覧](adr/)
- [ケアマネ業務調査レポート](research/care-manager-insights-2025.md)
- [Firestore スキーマ設計](adr/0004-firestore-schema.md)
